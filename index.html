<!DOCTYPE html>
<html lang="fr">
<head>
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="icon.png" type="image/png">
  <meta name="theme-color" content="#007bff">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fiche SantÃ©+</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #e0f7fa, #ffffff);
      margin: 0;
      padding: 20px;
    }
    .lang-toggle {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      margin-bottom: 10px;
    }
    .lang-toggle button img {
      width: 28px;
      height: 20px;
      border-radius: 0;
      transition: transform 0.2s ease;
      object-fit: contain;
    }
    .lang-toggle button:hover img {
      transform: scale(1.2);
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
    }
    .card {
      max-width: 420px;
      margin: 0 auto;
      background: #fff;
      border-radius: 20px;
      padding: 25px;
      box-shadow: 0 8px 20px rgba(0, 123, 255, 0.15);
      text-align: center;
    }
    .card h2 {
      color: #007bff;
    }
    .card p {
      text-align: left;
      margin: 5px 0;
    }
    #chatbot {
      position: fixed;
      bottom: 90px;
      right: 20px;
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      width: 320px;
      max-height: 400px;
      padding: 15px;
      overflow-y: auto;
      display: none;
    }
    #chatbot-icon {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 60px;
      height: 60px;
      background: #007bff;
      border-radius: 50%;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 1001;
    }
    #chatbot-icon img {
      width: 30px;
      height: 30px;
    }
      @media (max-width: 480px) {
      .card {
        padding: 15px;
        margin: 10px;
      }
      #chatbot {
        width: 90%;
        right: 5%;
      }
      #chatbot-icon {
        bottom: 15px;
        right: 15px;
      }
      .lang-toggle {
        justify-content: center;
        margin-bottom: 20px;
      }
    }
  </style>
</head>
<body>
<script>
  var currentLang = 'fr';
  var voicesLoaded = false;
  if ('speechSynthesis' in window) {
    window.speechSynthesis.onvoiceschanged = () => { voicesLoaded = true; };
  }
  function toggleChatbot() {
    const chatbot = document.getElementById("chatbot");
    if (chatbot && chatbot.style) {
      chatbot.style.display = chatbot.style.display === "none" || chatbot.style.display === "" ? "block" : "none";
    }
  }
  function switchLang(lang) {
  traduireChatbotButtons(lang);
  const name = document.getElementById('patient-name');
  if (name) name.textContent = lang === 'fr' ? 'Alexandre Dupont' : lang === 'en' ? 'Alexander Dupont' : 'Ø§Ù„ÙƒØ³Ù†Ø¯Ø± Ø¯ÙˆØ¨ÙˆÙ†';
  currentLang = lang;
  const maison = document.getElementById('btn-maison');
  const doctolib = document.getElementById('btn-doctolib');
  const urgence = document.getElementById('btn-urgence');

  if (maison) maison.textContent = lang === 'fr' ? 'ğŸ  ItinÃ©raire vers la maison' : lang === 'en' ? 'ğŸ  Directions home' : 'ğŸ  Ø§Ù„Ø§ØªØ¬Ø§Ù‡ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ù†Ø²Ù„';
  if (doctolib) doctolib.textContent = lang === 'fr' ? 'ğŸ©º Prendre rendez-vous sur Doctolib' : lang === 'en' ? 'ğŸ©º Book on Doctolib' : 'ğŸ©º Ø§Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯Ù‹Ø§ Ø¹Ø¨Ø± Doctolib';
  if (urgence) urgence.textContent = lang === 'fr' ? 'ğŸš¨ Appel Urgence' : lang === 'en' ? 'ğŸš¨ Emergency Call' : 'ğŸš¨ Ø§ØªØµØ§Ù„ Ø·Ø§Ø±Ø¦';

  const labels = {
    birthdate: {
      fr: 'Date de naissance',
      en: 'Date of Birth',
      ar: 'ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯'
    },
    blood: {
      fr: 'Groupe sanguin',
      en: 'Blood Group',
      ar: 'ÙØµÙŠÙ„Ø© Ø§Ù„Ø¯Ù…'
    },
    allergies: {
      fr: 'Allergies',
      en: 'Allergies',
      ar: 'Ø§Ù„Ø­Ø³Ø§Ø³ÙŠØ§Øª'
    },
    patho: {
      fr: 'Pathologies',
      en: 'Conditions',
      ar: 'Ø§Ù„Ø£Ù…Ø±Ø§Ø¶'
    },
    meds: {
      fr: 'MÃ©dicaments',
      en: 'Medications',
      ar: 'Ø§Ù„Ø£Ø¯ÙˆÙŠØ©'
    },
    hist: {
      fr: 'AntÃ©cÃ©dents',
      en: 'Medical History',
      ar: 'Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„Ø·Ø¨ÙŠ'
    },
    sos: {
      fr: "NumÃ©ro d'urgence",
      en: 'Emergency Contact',
      ar: 'Ø±Ù‚Ù… Ø§Ù„Ø·ÙˆØ§Ø±Ø¦'
    }
  };

  const translations = document.querySelectorAll(".card p");
  if (translations.length >= 7) {
    translations[0].innerHTML = `<strong>${labels.birthdate[lang]} :</strong> ${lang === 'fr' ? '12/06/1980 (43 ans)' : lang === 'en' ? '06/12/1980 (43 y.o.)' : '12/06/1980 (43 Ø¹Ø§Ù…Ù‹Ø§)'}`;
    translations[1].innerHTML = `<strong>${labels.blood[lang]} :</strong> O+`;
    translations[2].innerHTML = `<strong>${labels.allergies[lang]} :</strong> ${lang === 'fr' ? 'Arachides, Pollen' : lang === 'en' ? 'Peanuts, Pollen' : 'ÙÙˆÙ„ Ø³ÙˆØ¯Ø§Ù†ÙŠØŒ Ù„Ù‚Ø§Ø­'};`
    translations[3].innerHTML = `<strong>${labels.patho[lang]} :</strong> ${lang === 'fr' ? 'DiabÃ¨te Type 2' : lang === 'en' ? 'Type 2 Diabetes' : 'Ø¯Ø§Ø¡ Ø§Ù„Ø³ÙƒØ±ÙŠ Ø§Ù„Ù†ÙˆØ¹ 2'};`
    translations[4].innerHTML = `<strong>${labels.meds[lang]} :</strong> ${lang === 'fr' ? 'Insuline, ParacÃ©tamol' : lang === 'en' ? 'Insulin, Paracetamol' : 'Ø£Ù†Ø³ÙˆÙ„ÙŠÙ†ØŒ Ø¨Ø§Ø±Ø§Ø³ÙŠØªØ§Ù…ÙˆÙ„'};`
    translations[5].innerHTML = `<strong>${labels.hist[lang]} :</strong> ${lang === 'fr' ? 'Appendicectomie (2005), Hypertension' : lang === 'en' ? 'Appendectomy (2005), Hypertension' : 'Ø§Ø³ØªØ¦ØµØ§Ù„ Ø§Ù„Ø²Ø§Ø¦Ø¯Ø© (2005)ØŒ Ø§Ø±ØªÙØ§Ø¹ Ø¶ØºØ· Ø§Ù„Ø¯Ù…'};`
    translations[6].innerHTML = `<strong>${labels.sos[lang]} :</strong> <a href='tel:+33652805105'>06 52 80 51 05</a>`;
  }
}
</script>

<div class="lang-toggle">
  <button onclick="switchLang('fr')" style="background: none; border: none; padding: 0;"><img src="france.png" alt="FR"></button>
  <button onclick="switchLang('en')" style="background: none; border: none; padding: 0;"><img src="united-kingdom.png" alt="EN"></button>
  <button onclick="switchLang('ar')" style="background: none; border: none; padding: 0;"><img src="saudi-arabia.png" alt="AR"></button>
</div>

<div class="card">
  <img src="tete.png" alt="Photo patient" style="display: block; margin: 0 auto 15px auto; width: 120px; height: 120px; border-radius: 50%;">
  <h2 id="patient-name">Alexandre Dupont</h2>
  <br>
  <p><strong>Date de naissance :</strong> 12/06/1980 (43 ans)</p>
  <br>
  <p><strong>Groupe sanguin :</strong> O+</p>
  <br>
  <p><strong>Allergies :</strong> Arachides, Pollen</p>
  <br>
  <p><strong>Pathologies :</strong> DiabÃ¨te Type 2</p>
  <br>
  <p><strong>MÃ©dicaments :</strong> Insuline, ParacÃ©tamol</p>
  <br>
  <p><strong>AntÃ©cÃ©dents :</strong> Appendicectomie (2005), Hypertension</p>
  <br>
  <p><strong>NumÃ©ro medecin traitant:</strong> <a href='tel:+33652805105'>06 52 89 51 09</a></p>
  <br>
  <a id="btn-urgence" href="tel:112" style="display: block; background: red; color: white; text-align: center; padding: 10px; border-radius: 16px; margin-top: 10px; text-decoration: none; transition: background 0.3s ease;" onmouseover="this.style.opacity='0.9'" onmouseout="this.style.opacity='1'">ğŸš¨ Appel Urgence</a>
  <a id="btn-maison" href="https://www.google.com/maps/dir/?api=1&destination=3+Av+Joseph+Bedier+75013+Paris" target="_blank" style="display: block; background: #007bff; color: white; text-align: center; padding: 10px; border-radius: 16px; margin-top: 10px; text-decoration: none;">ğŸ  ItinÃ©raire vers la maison</a>
  <a id="btn-doctolib" href="https://www.doctolib.fr/" style="display: block; background: #28a745; color: white; text-align: center; padding: 10px; border-radius: 16px; margin-top: 10px; text-decoration: none;">ğŸ©º Prendre rendez-vous sur Doctolib</a>
</div>

<div id="chatbot">
  <div id="chatbot-history"></div>
  <textarea id="chat-input" placeholder="Posez votre question..." style="width: 100%; height: 50px; margin-top: 10px;"></textarea>
  <button onclick="repondreQuestion()" style="margin-top: 5px;">Envoyer</button>
  <button onclick="activerMicro()">ğŸ¤ Parler</button>
  <button onclick="afficherQuestions()">ğŸ“‹ Voir les exemples de questions</button>
  <div id="question-exemples" style="display:none;"></div>
</div>
<div id="chatbot-icon" onclick="toggleChatbot()">
  <img src="https://cdn-icons-png.flaticon.com/512/4712/4712027.png" alt="Chat">
</div>

<script>
function repondreQuestion() {
  const question = document.getElementById("chat-input").value.trim().toLowerCase();
  const history = document.getElementById("chatbot-history");
  let response;

  if (question.includes("fiÃ¨vre") || question.includes("fever") || question.includes("Ø­Ù…Ù‰")) {
    response = {
      fr: "La fiÃ¨vre est un symptÃ´me courant. Buvez beaucoup d'eau et reposez-vous.",
      en: "Fever is a common symptom. Drink plenty of water and rest.",
      ar: "Ø§Ù„Ø­Ù…Ù‰ Ø¹Ø±Ø¶ Ø´Ø§Ø¦Ø¹. Ø§Ø´Ø±Ø¨ Ø§Ù„ÙƒØ«ÙŠØ± Ù…Ù† Ø§Ù„Ù…Ø§Ø¡ ÙˆØ§Ø³ØªØ±Ø­."
    }[currentLang];
  } else if (question.includes("toux") || question.includes("cough") || question.includes("Ø³Ø¹Ø§Ù„")) {
    response = {
      fr: "Pour la toux, Ã©vitez le froid et buvez des infusions.",
      en: "For cough, avoid cold drinks and take herbal tea.",
      ar: "Ù„Ø¹Ù„Ø§Ø¬ Ø§Ù„Ø³Ø¹Ø§Ù„ØŒ ØªØ¬Ù†Ø¨ Ø§Ù„Ù…Ø´Ø±ÙˆØ¨Ø§Øª Ø§Ù„Ø¨Ø§Ø±Ø¯Ø© ÙˆØ®Ø° Ø´Ø§ÙŠ Ø£Ø¹Ø´Ø§Ø¨."
    }[currentLang];
  } else if (question.includes("douleur") || question.includes("pain") || question.includes("Ø£Ù„Ù…")) {
    response = {
      fr: "En cas de douleur, reposez-vous et utilisez un antidouleur si nÃ©cessaire. Consultez un mÃ©decin si la douleur persiste.",
      en: "If you're in pain, rest and take a painkiller if needed. Consult a doctor if the pain continues.",
      ar: "ÙÙŠ Ø­Ø§Ù„ ÙˆØ¬ÙˆØ¯ Ø£Ù„Ù…ØŒ Ø§Ø³ØªØ±Ø­ ÙˆØ®Ø° Ù…Ø³ÙƒÙ†Ù‹Ø§ Ø¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø±. Ø±Ø§Ø¬Ø¹ Ø·Ø¨ÙŠØ¨Ù‹Ø§ Ø¥Ø°Ø§ Ø§Ø³ØªÙ…Ø± Ø§Ù„Ø£Ù„Ù…."
    }[currentLang];
  } else if (question.includes("stress") || question.includes("anxiÃ©tÃ©") || question.includes("anxiety") || question.includes("ØªÙˆØªØ±")) {
    response = {
      fr: "Essayez de respirer profondÃ©ment et de vous dÃ©tendre. Parlez Ã  un professionnel de santÃ© si cela persiste.",
      en: "Try deep breathing and relaxation. Talk to a healthcare professional if it continues.",
      ar: "Ø­Ø§ÙˆÙ„ Ø§Ù„ØªÙ†ÙØ³ Ø¨Ø¹Ù…Ù‚ ÙˆØ§Ù„Ø§Ø³ØªØ±Ø®Ø§Ø¡. ØªØ­Ø¯Ø« Ø¥Ù„Ù‰ Ù…Ø®ØªØµ ØµØ­ÙŠ Ø¥Ø°Ø§ Ø§Ø³ØªÙ…Ø± Ø§Ù„Ø£Ù…Ø±."
    }[currentLang];
  } else {
    response = {
      fr: "Merci pour votre question. Je vous recommande de consulter un professionnel de santÃ©.",
      en: "Thank you for your question. I recommend seeing a healthcare professional.",
      ar: "Ø´ÙƒØ±Ù‹Ø§ Ø¹Ù„Ù‰ Ø³Ø¤Ø§Ù„Ùƒ. Ø£Ù†ØµØ­Ùƒ Ø¨Ù…Ø±Ø§Ø¬Ø¹Ø© Ù…Ø®ØªØµ ØµØ­ÙŠ."
    }[currentLang];
  }

  history.innerHTML += `<p><strong>Vous :</strong> ${question}</p><p><strong>Bot :</strong> ${response}</p>`;
  document.getElementById("chat-input").value = "";
}

function traduireChatbotButtons(lang) {
  const sendBtn = document.querySelector("#chatbot button[onclick='repondreQuestion()']");
  const voiceBtn = document.querySelector("#chatbot button[onclick='activerMicro()']");
  const examplesBtn = document.querySelector("#chatbot button[onclick='afficherQuestions()']");

  if (sendBtn) sendBtn.textContent = lang === 'fr' ? 'Envoyer' : lang === 'en' ? 'Send' : 'Ø¥Ø±Ø³Ø§Ù„';
  if (voiceBtn) voiceBtn.textContent = lang === 'fr' ? 'ğŸ¤ Parler' : lang === 'en' ? 'ğŸ¤ Speak' : 'ğŸ¤ ØªØ­Ø¯Ø«';
  if (examplesBtn) examplesBtn.textContent = lang === 'fr' ? 'ğŸ“‹ Voir les exemples de questions' : lang === 'en' ? 'ğŸ“‹ See sample questions' : 'ğŸ“‹ Ø¹Ø±Ø¶ Ø£Ù…Ø«Ù„Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø©';
}
traduireChatbotButtons(currentLang);

function afficherQuestions() {
  const questions = {
    fr: ["Jâ€™ai de la fiÃ¨vre", "Je tousse beaucoup", "Jâ€™ai oubliÃ© mes mÃ©dicaments", "Jâ€™ai une douleur Ã  la tÃªte", "Est-ce que jâ€™ai la grippe ?", "Je souffre dâ€™allergie", "Ma tension est Ã©levÃ©e"],
    en: ["I have a fever", "I'm coughing a lot", "I forgot my medicine", "I have a headache", "Do I have the flu?", "I have allergies", "My blood pressure is high"],
    ar: ["Ø£Ø¹Ø§Ù†ÙŠ Ù…Ù† Ø§Ù„Ø­Ù…Ù‰", "Ø£Ø³Ø¹Ù„ ÙƒØ«ÙŠØ±Ù‹Ø§", "Ù†Ø³ÙŠØª Ø¯ÙˆØ§Ø¦ÙŠ", "Ø£Ø´Ø¹Ø± Ø¨Ø£Ù„Ù… ÙÙŠ Ø±Ø£Ø³ÙŠ", "Ù‡Ù„ Ù„Ø¯ÙŠ Ø¥Ù†ÙÙ„ÙˆÙ†Ø²Ø§ØŸ", "Ø£Ø¹Ø§Ù†ÙŠ Ù…Ù† Ø­Ø³Ø§Ø³ÙŠØ©", "Ø¶ØºØ· Ø¯Ù…ÙŠ Ù…Ø±ØªÙØ¹"]
  };
  const zone = document.getElementById("question-exemples");
  const selected = questions[currentLang];
  zone.innerHTML = `<ul style='padding-left: 20px; margin-top: 6px;'>${selected.map(q => `<li>${q}</li>`).join('')}</ul>`;
  zone.style.display = zone.style.display === "none" ? "block" : "none";
}
</script>

<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', function() {
      navigator.serviceWorker.register('sw.js').then(function(registration) {
        console.log('ServiceWorker registration successful with scope: ', registration.scope);
      }, function(err) {
        console.log('ServiceWorker registration failed: ', err);
      });
    });
  }
</script>
</body>
</html>
